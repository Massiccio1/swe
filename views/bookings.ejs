<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TutorMe</title>
    <link rel="stylesheet" href="/css/studentHomePage.css">
</head>
<body>
    <header>
        <a href="/students/secure/home/"><img src="/images/TutorMe_logo.png" style="width:250px;height:50px;"> </a>
        <nav>
            <a href="/students/secure/home/">Home</a>
            <a href="/view-tutors/">Find a tutor</a>
            <a href="/students/secure/messages/">Messages</a>
        </nav>
        <p class="myProfile">My Profile</p>
        <img class="myProfile" src="/images/arrow_prof.png" style="width:48px;height:15px;">
        <div class="dropdown" style="float:right;">
            <a href="#students/secure/profile/"><img class="dropbtn" src="/images/studentProfile.png" style="width:60px;height:55px;"></a>
            <div class="dropdown-content">
                <a href="/api/v1/authentications/logout">Log-out</a>
            </div>
        </div>
    </header>
    <h1>Hi there!<img src="/images/waving.png" style="width:35px;height:38px;"></h1>
    <main class="secondMain">
      <ul id="bookings">
      </ul>
    </main>
    <script> function loadBookings() {

        const cookies = document.cookie.split("; "); // Ottieni tutti i cookie come array
        let token = null;
        
        for (let i = 0; i < cookies.length; i++) {
          const cookie = cookies[i].split("=");
          if (cookie[0] === "token") {
            token = cookie[1];
            break;
          }
        }
            var prenotations = document.getElementById("bookings");
            const url = "/api/v1/prenotations";
          
            fetch('/api/v1/prenotations', {
              method: 'GET',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`,
              }
            })
              .then((resp) => resp.json())
              .then((prenotazioni) => {
                prenotazioni.forEach((prenotazione) => {
                  let li = document.createElement('li');
                  li.textContent = prenotazione.CourseId + ' ' + prenotazione.timeslot;
                  prenotations.appendChild(li);
                });
              })
              .catch((error) => {
                console.log(error);
              });
          }
        
          loadBookings();
          </script>
    
</body>
</html>


